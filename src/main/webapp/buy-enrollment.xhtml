<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                template="/WEB-INF/template.xhtml">
    <f:metadata>
        <f:viewAction action="#{purchaseView.prepareEnrollment}" />
    </f:metadata>
    <ui:define name="title">Buy Enrollment PINs</ui:define>
    <ui:define name="content">
        <section class="mb-5" aria-labelledby="enrollmentHeading">
            <div class="row g-5 align-items-center">
                <div class="col-12 col-lg-7">
                    <h1 id="enrollmentHeading" class="display-6 fw-bold mb-3">Purchase enrollment PINs</h1>
                    <p class="lead text-muted">Choose the applicant type and issuance stage. Get masked codes instantly or generate an invoice for later payment.</p>
                </div>
                <div class="col-12 col-lg-5">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <h2 class="h5 mb-3">Why Veristore</h2>
                            <ul class="list-unstyled text-muted small mb-0">
                                <li class="mb-2">Pre-seeded vault ensures PIN availability across all enrollment variants.</li>
                                <li class="mb-2">Contact preferences let you send deliveries to email, SMS, or both.</li>
                                <li class="mb-0">Invoices integrate with the mock Hubtel gateway for easy payment simulation.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section aria-labelledby="enrollmentFormHeading">
            <div class="row g-4">
                <div class="col-12 col-lg-7">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <h2 id="enrollmentFormHeading" class="h4 mb-4">Order details</h2>
                            <h:form id="enrollmentForm">
                                <div class="row g-3">
                                    <div class="col-12 col-md-6">
                                        <h:outputLabel for="email" value="Email" styleClass="form-label" />
                                        <h:inputText id="email"
                                                     value="#{purchaseView.email}"
                                                     required="true"
                                                     requiredMessage="Email is required"
                                                     pt:type="email"
                                                     styleClass="form-control form-control-lg" />
                                        <h:message for="email" styleClass="text-danger small" />
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <h:outputLabel for="msisdn" value="Phone number" styleClass="form-label" />
                                        <h:inputText id="msisdn"
                                                     value="#{purchaseView.msisdn}"
                                                     required="true"
                                                     requiredMessage="Phone number is required"
                                                     styleClass="form-control form-control-lg" />
                                        <h:message for="msisdn" styleClass="text-danger small" />
                                    </div>
                                    <div class="col-12">
                                        <h:outputLabel for="variant" value="Enrollment variant" styleClass="form-label" />
                                        <h:selectOneMenu id="variant"
                                                         value="#{purchaseView.variant}"
                                                         styleClass="form-select form-select-lg">
                                            <f:selectItems value="#{purchaseView.variantOptions}" />
                                        </h:selectOneMenu>
                                        <h:message for="variant" styleClass="text-danger small" />
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <h:outputLabel for="quantity" value="Quantity" styleClass="form-label" />
                                        <h:inputText id="quantity"
                                                     value="#{purchaseView.qty}"
                                                     pt:type="number"
                                                     pt:min="1"
                                                     required="true"
                                                     requiredMessage="Quantity is required"
                                                     styleClass="form-control form-control-lg" />
                                        <h:message for="quantity" styleClass="text-danger small" />
                                    </div>
                                    <div class="col-12">
                                        <span class="form-label d-block">Delivery preferences</span>
                                        <div class="form-check form-check-inline">
                                            <h:selectBooleanCheckbox id="deliverEmail"
                                                                     value="#{purchaseView.deliverByEmail}"
                                                                     styleClass="form-check-input" />
                                            <h:outputLabel for="deliverEmail" value="Email" styleClass="form-check-label" pt:aria-label="Deliver via email" />
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <h:selectBooleanCheckbox id="deliverSms"
                                                                     value="#{purchaseView.deliverBySms}"
                                                                     styleClass="form-check-input" />
                                            <h:outputLabel for="deliverSms" value="SMS" styleClass="form-check-label" pt:aria-label="Deliver via SMS" />
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex flex-column flex-sm-row gap-3 mt-4">
                                    <h:commandButton value="Pay now"
                                                     styleClass="btn btn-primary btn-lg"
                                                     action="#{purchaseView.submitPayNow}" />
                                    <h:commandButton value="Get invoice"
                                                     styleClass="btn btn-outline-primary btn-lg"
                                                     action="#{purchaseView.submitPayLater}" />
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-5">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <h2 class="h5 mb-3">Order summary</h2>
                            <dl class="row mb-0 small">
                                <dt class="col-6 text-muted">Service</dt>
                                <dd class="col-6 text-end">#{purchaseView.variantLabel}</dd>
                                <dt class="col-6 text-muted">Unit price</dt>
                                <dd class="col-6 text-end">#{purchaseView.unitPrice}</dd>
                                <dt class="col-6 text-muted">Quantity</dt>
                                <dd class="col-6 text-end">#{purchaseView.qty}</dd>
                                <dt class="col-6 text-muted">Estimated total</dt>
                                <dd class="col-6 text-end fw-semibold">#{purchaseView.total}</dd>
                            </dl>
                            <p class="text-muted small mt-3 mb-0">We only display masked codes. Full delivery occurs via the secure channel you select above.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </ui:define>
</ui:composition>
