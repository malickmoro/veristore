<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
    <f:view locale="#{globalView.locale}">
        <h:head>
            <meta charset="utf-8" />
            <meta name="viewport" content="width=device-width, initial-scale=1" />
            <title><ui:insert name="title">Veristore</ui:insert></title>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous"/>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"/>
            <style>
                .selectable-card,
                .product-card {
                    position: relative;
                    border: 1px solid var(--bs-border-color-translucent);
                    border-radius: 1rem;
                    background-color: var(--bs-body-bg);
                    transition: border-color .2s ease, box-shadow .2s ease, transform .2s ease;
                    min-height: 100%;
                }

                .choice-card,
                .tier-card,
                .product-detail-card {
                    position: relative;
                    border-radius: 1.5rem;
                    border: 1px solid rgba(15, 23, 42, .08);
                    background: linear-gradient(135deg, rgba(255,255,255,.95), rgba(248,249,252,.9));
                    box-shadow: 0 .5rem 1.5rem rgba(15, 23, 42, .08);
                    transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
                    overflow: hidden;
                }

                .choice-card:hover,
                .tier-card:hover,
                .product-detail-card:hover {
                    transform: translateY(-6px) scale(1.01);
                    box-shadow: 0 1.25rem 2.5rem rgba(15, 23, 42, .15);
                    border-color: rgba(13, 110, 253, .35);
                }

                .choice-card.selected,
                .tier-card.selected {
                    border-color: rgba(13, 110, 253, .45);
                    box-shadow: 0 1.5rem 3rem rgba(13, 110, 253, .2);
                }

                .choice-card.selected::before {
                    content: '\2713';
                    position: absolute;
                    top: .85rem;
                    inset-inline-end: 1rem;
                    width: 2.25rem;
                    height: 2.25rem;
                    border-radius: 50%;
                    background-color: rgba(13, 110, 253, .18);
                    color: var(--bs-primary);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1.1rem;
                    font-weight: 600;
                    z-index: 2;
                }

                .choice-card::after,
                .tier-card::after {
                    content: "";
                    position: absolute;
                    inset: 0;
                    background: radial-gradient(circle at top right, rgba(13, 110, 253, .15), transparent 55%);
                    opacity: 0;
                    transition: opacity .25s ease;
                }

                .choice-card:hover::after,
                .choice-card.selected::after,
                .tier-card:hover::after,
                .tier-card.selected::after {
                    opacity: 1;
                }

                .choice-card .card-body,
                .tier-card .card-body {
                    position: relative;
                    padding: 2rem;
                    z-index: 1;
                }

                .choice-card-icon {
                    font-size: 2.5rem;
                    line-height: 1;
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    width: 3.75rem;
                    height: 3.75rem;
                    border-radius: 1.25rem;
                    background: rgba(13, 110, 253, .1);
                    color: var(--bs-primary);
                    margin-bottom: 1rem;
                    position: relative;
                    z-index: 3;
                }

                .tier-card .price-tag {
                    font-size: 1.5rem;
                    font-weight: 700;
                    color: var(--bs-primary);
                }

                .tier-card .shimmer-hover {
                    position: relative;
                    overflow: hidden;
                }

                .tier-card .shimmer-hover::after {
                    content: "";
                    position: absolute;
                    inset: -150% -40% 0 0;
                    background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,.5) 50%, transparent 100%);
                    transform: skewX(-25deg);
                    transition: transform .6s ease;
                }

                .tier-card:hover .shimmer-hover::after,
                .tier-card.selected .shimmer-hover::after {
                    transform: translateX(200%) skewX(-25deg);
                }

                .product-detail-card .card-body {
                    padding: 2.25rem;
                }

                .product-detail-card .detail-grid dt {
                    font-weight: 600;
                    color: rgba(15, 23, 42, .7);
                }

                .product-detail-card .detail-grid dd {
                    margin-bottom: .75rem;
                }

                .selectable-card .card-body,
                .product-card .card-body {
                    padding: 1.5rem;
                }

                .selectable-card:hover,
                .product-card:hover {
                    border-color: var(--bs-primary);
                    box-shadow: 0 .75rem 2rem rgba(13, 110, 253, .15);
                    transform: translateY(-4px);
                }

                .selectable-card.selected,
                .product-card.selected {
                    border-color: var(--bs-primary);
                    box-shadow: 0 .75rem 2rem rgba(13, 110, 253, .25);
                }

                .selectable-card.selected::after,
                .product-card.selected::after {
                    content: '\2713';
                    position: absolute;
                    top: .75rem;
                    inset-inline-end: .75rem;
                    width: 2rem;
                    height: 2rem;
                    border-radius: 50%;
                    background-color: rgba(13, 110, 253, .15);
                    color: var(--bs-primary);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1rem;
                    font-weight: 600;
                }

                .product-card .badge {
                    font-weight: 600;
                    font-size: .75rem;
                    letter-spacing: .02em;
                }

                .selectable-card .stretched-link,
                .product-card .btn {
                    text-decoration: none;
                }

                .product-card.selected .btn {
                    border-color: var(--bs-primary);
                    background-color: var(--bs-primary);
                    color: var(--bs-white);
                }
            </style>
            <ui:insert name="styles" />
        </h:head>
        <h:body class="d-flex flex-column min-vh-100 bg-light text-body"
                dir="#{globalView.rtl ? 'rtl' : 'ltr'}" pt:lang="#{globalView.localeCode}">
            <a href="#main" class="visually-hidden-focusable position-absolute top-0 start-0 m-3 px-3 py-2 bg-dark text-light rounded">Skip to main content</a>
            <ui:include src="/WEB-INF/partials/navbar.xhtml" />

            <main id="main" class="flex-grow-1">
                <div class="container py-4 py-lg-5">
                    <h:panelGroup layout="block"
                                  rendered="#{not empty facesContext.messageList}"
                                  styleClass="mb-4"
                                  pt:aria-live="polite"
                                  pt:aria-atomic="true">
                        <h:messages id="globalMessages"
                                    showSummary="true"
                                    showDetail="false"
                                    layout="list"
                                    styleClass="list-unstyled d-flex flex-column gap-3 mb-0"
                                    globalOnly="true"
                                    infoClass="alert alert-info alert-dismissible fade show mb-0"
                                    warnClass="alert alert-warning alert-dismissible fade show mb-0"
                                    errorClass="alert alert-danger alert-dismissible fade show mb-0"
                                    fatalClass="alert alert-danger alert-dismissible fade show mb-0"
                                    pt:role="alert" />
                    </h:panelGroup>
                    <ui:insert name="content" />
                </div>
            </main>

            <!-- Loading Indicator -->
            <div id="loadingIndicator" class="position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center" 
                 style="background-color: rgba(0, 0, 0, 0.5); z-index: 9999; display: none !important;">
                <div class="bg-white rounded-4 p-4 text-center shadow-lg">
                    <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <div class="text-muted">Processing your request...</div>
                </div>
            </div>

            <ui:include src="/WEB-INF/partials/footer.xhtml" />

            <h:outputScript target="body">
                //<![CDATA[
                (function () {
                var messageList = document.getElementById('globalMessages');
                if (!messageList) {
                return;
                }
                messageList.querySelectorAll('li.alert-dismissible').forEach(function (item) {
                item.setAttribute('role', 'alert');
                if (item.querySelector('[data-bs-dismiss="alert"]')) {
                return;
                }
                var button = document.createElement('button');
                button.type = 'button';
                button.className = 'btn-close';
                button.setAttribute('data-bs-dismiss', 'alert');
                button.setAttribute('aria-label', 'Dismiss message');
                item.appendChild(button);
                });
                })();
                //]]>
            </h:outputScript>
            <ui:insert name="scripts" />
        </h:body>
    </f:view>
</ui:composition>